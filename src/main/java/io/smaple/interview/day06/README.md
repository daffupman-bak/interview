# 面试题收纳（六）

1、redis作为缓存带来的问题？

- 缓存雪崩：大量缓存的数据一起失效，同时迎来大量的访问请求。设置多级缓存，或把缓存数据的过期时间尽量分散。
- 缓存穿透：访问不存在与redis中的数据。将查询到不存在的数据也设置到缓存中。
- 缓存击穿：大量请求访问一个刚刚失效的数据。

2、cdn的作用

cdn是基于现有网络基础之上的网络，通过中心平台的负载均衡、内容分发、调度等，使用户可以就近获取所需内容，降低网络拥塞，提高用户访问速度。

3、网站卡顿怎么办

- 查看整机情况：`top`

    关键参数有%CPU，%MEM，PID，COMMAND。load average十分重要，三个数字分别表示系统前1min，5min，15,min的平均负载值。三者的平均值大于0.6的话系统有变慢的风险，高于0.8，系统即将崩溃。按数字1，可查看所有CPU核心数的情况。zombie表示僵死线程，为0是最好的。id表示idle，表示系统的空闲指数，较高的数值表示系统流畅。
    > 精简指令：`uptime`
    
- 查看CPU情况：`vmstat -n 2 3`

    每隔两秒采一次样，共采3次。procs下的r，表示等待cpu的进程数。一般每个核心不能超过2个，总的运行队列不超过总核数的2倍。b表示等待资源的线程数。cpu下的us表示用户进程消耗cpu时间的百分比，sy表示内核进程消耗时间的百分比，id表示处于空闲的时间百分比，wa表示处于等待IO的时间百分比，st表示偷取的时间百分比。
    
    `mpstat -P ALL 2`：查看所有cpu核心的信息，%idle小于60%，系统有变慢的趋势
    
    `pidstat -p <pid> -u 2`：每隔两秒获取cpu的信息
    
- 查看内存情况：`free`
    
    以字节为单位，显示可用内存。参数`-g`，是以GB为单位，`-m`是以MB为单位。`20% < free%total < 70%` 内存基本够用，小于20%内存不足，大于70%内存充足。
    
    `pidstat -p <pid> -r 2`：每隔两秒获取内存的信息。
    > majflt/s：任务每秒发生的主要错误，需要中磁盘中加载页 
    > minfls/s：任务每秒发生的次要错误，不需要从磁盘中加载页
    > VSZ：虚拟地址大小，单位KB
    > RSS：常驻集合大小

- 查看磁盘情况：`df -h`

- 查看磁盘IO性能：`iostat -xdk 2 3`

    util表示每秒用于IO操作的时间百分比，接近100%时需要优化。
    
    `pidstat -p <pid> -d 2`：每个2秒获取磁盘io情况。
    